<!--  
    AJAX -- Asynchronous Javascript and XML
    AJAX - Technique
    AJAX - existing technology  ( Javascript , HTML,CSS)
    AJAX - Without page refresh Browser to  server side communication (POST,GET,PUT,DELETE)
    AJAX - XMLHttpRequest (XHR)
    AJAX - it will change only portion of the page dynamically
    AJax - client side (Browser or user Agent)

    IE5 - ActiveXObject
    IE6 - Mozilla (w3c) - XHR
-->

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

<noscript>
    <h1>No Script</h1>
</noscript>

<button>Enter</button>
<p>
    Lorem ipsum dolor sit, amet consectetur adipisicing elit. Necessitatibus dolores quis neque adipisci harum incidunt ullam, alias iusto ea aliquam minima, architecto repellat ipsum. Minus ullam itaque minima totam ab.
</p>

<div class="container">
    <div class="row"></div>
</div>

<script>
    // var xmlhttp = new XMLHttpRequest(); 
    // console.log(xmlhttp);

    // var xmlhttp1 = new ActiveXObject("Microsoft.XMLHTTP");
    // console.log(xmlhttp1);

    document.querySelector('button').onclick = function(){
        var xmlhttp = new XMLHttpRequest(); 
        console.log(xmlhttp);
        console.log(xmlhttp.readyState);
        //0 Till now no Request is initialized by user

        xmlhttp.onreadystatechange = function(){
            console.log(xmlhttp.readyState,xmlhttp.status);

            if(xmlhttp.readyState==4 && xmlhttp.status==404){
                document.querySelector('p').innerHTML = 'FAILED';
            }
            if(xmlhttp.readyState==4 && xmlhttp.status==200){
                console.log(typeof xmlhttp.responseText);
                console.log(xmlhttp.responseText);

                var ans = JSON.parse(xmlhttp.responseText);
                console.log(ans);

               //shrt circuit operator
                ans && ans.length>0 && ans.forEach(({title,price,image})=>{
                    // console.log(obj);
                    // console.log(obj);
                    // console.log(title,price,image);
                    var divTag = document.createElement("div");
                    divTag.className = 'col-3';
                    var imgTag = document.createElement("img");
                    imgTag.src = image;
                    imgTag.className = 'img-fluid';


                    divTag.append(imgTag);
                    document.querySelector('.row').append(divTag);
                })
               
            }
        }

        xmlhttp.open('GET','https://fakestoreapi.com/products')
        // xmlhttp.open('POST','https://fakestoreapi.com/products')
         //1 Request has been setup with server side page

        xmlhttp.send();
        // xmlhttp.send("name='ajay'&age=20");
        // xmlhttp.setHeaders({"contentType":"application/json"})
        //request has been sent to server side page
    }
</script>